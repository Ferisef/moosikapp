(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,function(e,t,a){e.exports={playControls:"player_playControls__3zSMS",wrapper:"player_wrapper__2pvXA",controls:"player_controls__yrmwU",control:"player_control__1GAJR",controlIcon:"player_controlIcon__2enCG",volume:"player_volume__3Swwg",volumeWrapper:"player_volumeWrapper__1fz4y",volumeBackground:"player_volumeBackground__1nr9H",volumeBar:"player_volumeBar__64T8Y"}},,,,,,function(e,t,a){e.exports={upload:"upload_upload__2gDVd",head:"upload_head__2A3iY",body:"upload_body__1ran0",instruction:"upload_instruction__2mNHY",field:"upload_field__1SmGY",additionalInfo:"upload_additionalInfo__2XUOw",title:"upload_title__26joS",fileInput:"upload_fileInput__3OG6N",textInput:"upload_textInput__3_Gii",submitButton:"upload_submitButton__eey2a",selectedFile:"upload_selectedFile__29FyA",error:"upload_error__2VbC4"}},,function(e,t,a){e.exports={register:"register_register__3K1Qz",head:"register_head__1AMVY",body:"register_body__1iskS",field:"register_field__3uUA2",textInput:"register_textInput__BhK6k",submitButton:"register_submitButton__1XgYC",link:"register_link__KC47u",error:"register_error__SYCt0"}},,function(e,t,a){e.exports={login:"login_login__KNSyK",head:"login_head__2qiIv",body:"login_body__3wG4D",field:"login_field__21SYK",right:"login_right__2EU-W",textInput:"login_textInput__2Kmaj",submitButton:"login_submitButton__3uEsL",link:"login_link__QwjVM",error:"login_error__37faC"}},,,,,,function(e,t,a){e.exports={song:"song_song__1MoGw",cover:"song_cover__1Z4fR",defaultCover:"song_defaultCover__1Scdp",play:"song_play__3MQc2",container:"song_container__16ZNc",actions:"song_actions__2A91g",button:"song_button__sSeHU",info:"song_info__jIaQd",title:"song_title__2OYyJ",author:"song_author__2GBdg"}},function(e,t,a){e.exports={box:"header_box__1usNr",container:"header_container__lX8hc",left:"header_left__oqI23",logo:"header_logo__2Sn9n",nav:"header_nav__29j8I",link:"header_link__3JPaZ"}},function(e,t,a){e.exports={forgot:"forgot_forgot__6N7KH",head:"forgot_head__3pS99",body:"forgot_body__3AacY",instruction:"forgot_instruction__PGYWn",field:"forgot_field__3U1Yy",textInput:"forgot_textInput__3O7zC",submitButton:"forgot_submitButton__3CaVw",error:"forgot_error__FFRMY"}},,function(e,t,a){e.exports={status:"status_status__1dbQM",head:"status_head__dMJh8",body:"status_body__3W00t",prop:"status_prop__2iTYX",error:"status_error__9tzak"}},function(e,t,a){e.exports={soundBadge:"soundBadge_soundBadge__hUvOb",cover:"soundBadge_cover__3DUfa",titleContextContainer:"soundBadge_titleContextContainer__8tE46",title:"soundBadge_title__3Wt33",author:"soundBadge_author__2z1MH",truncate:"soundBadge_truncate__3U-6n"}},function(e,t,a){e.exports={timeline:"timeline_timeline__3ng4V",progressWrapper:"timeline_progressWrapper__2Mxxn",progressBackground:"timeline_progressBackground__VsvSl",progressBar:"timeline_progressBar__2sPc6",timePassed:"timeline_timePassed__pmNyr",duration:"timeline_duration__1I6eB"}},,,function(e,t,a){e.exports=a.p+"static/media/icons.229871f7.svg"},,,function(e,t,a){e.exports=a.p+"static/media/icons.1ac17924.svg"},function(e,t,a){e.exports={music:"music_music__2H0ii",head:"music_head__15ijt",songList:"music_songList__1p17f",error:"music_error__3-l_i",warn:"music_warn__1ax-M"}},,,,,function(e,t,a){e.exports={app:"app_app__12nIj",background:"app_background__2Zzp2",container:"app_container__6cU4e"}},,,,,,,,,function(e,t,a){e.exports={main:"main_main__3rTl_"}},function(e,t,a){e.exports=a.p+"static/media/bg.35f444d6.jpg"},function(e,t,a){e.exports=a(62)},,,,,,,,,,,,,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(34),s=a.n(o),i=a(2),l=a(10),c=a(4),u=a(5),m=a(7),p=a(6),d=a(8),h=a(22),_=function(e){return{type:"SET_TOKEN",payload:e}},f=a(20),g=a.n(f),v=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"logout",value:function(){var e=this;return function(t){t.preventDefault();var a=e.props,n=a.setToken,r=a.history;n(""),window.localStorage.removeItem("token"),r.push("/login")}}},{key:"render",value:function(){var e=this.props.token;return r.a.createElement("header",{className:g.a.box},r.a.createElement("div",{className:g.a.container},r.a.createElement("div",{className:g.a.left},r.a.createElement(l.b,{className:g.a.logo,to:"/"},r.a.createElement("svg",{viewBox:"0 0 48 48"},r.a.createElement("path",{d:"M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h8v2H24v4h12c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"}))),e&&r.a.createElement("nav",{className:g.a.nav},r.a.createElement(l.b,{className:g.a.link,to:"/music"},"Music"),r.a.createElement(l.b,{className:g.a.link,to:"/upload"},"Upload"))),!e&&r.a.createElement(l.b,{className:g.a.link,to:"/login"},"Login"),e&&r.a.createElement(l.b,{className:g.a.link,to:"?logout",onClick:this.logout()},"Logout")))}}]),t}(r.a.Component),b=Object(i.b)(function(e){return{token:e.login.token}},function(e){return{setToken:function(t){return e(_(t))}}})(Object(h.e)(v)),E=a(36),y=a.n(E),k=a(23),N=a.n(k),w=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_URL,j=void 0===w?"":w,O=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={storage:null,error:null},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.updateStatus(),this.interval=setInterval(function(){return e.updateStatus()},3e5)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"updateStatus",value:function(){var e=this;fetch("".concat(j,"/api/status"),{method:"GET",headers:{accept:"application/vnd.moosik.v1+json","content-type":"application/json"}}).then(function(e){return e.json()}).then(function(t){var a=t.storage;e.setState({storage:a})}).catch(function(t){return e.setState({error:t.toString()})})}},{key:"render",value:function(){var e=this.state,t=e.storage,a=e.error;return r.a.createElement("section",{className:N.a.status},r.a.createElement("h1",{className:N.a.head},"Storage Status"),t&&r.a.createElement("div",{className:N.a.body},r.a.createElement("p",{className:N.a.prop},"Total Space:\u2002",r.a.createElement("span",null,y()(t.totalSpace))),r.a.createElement("p",{className:N.a.prop},"Used Space:\u2002",r.a.createElement("span",null,y()(t.usedSpace))),r.a.createElement("p",{className:N.a.prop},"Max File Size:\u2002",r.a.createElement("span",null,y()(t.maxFileSize)))),a&&r.a.createElement("p",{className:N.a.error},a))}}]),t}(r.a.Component),S=a(12),x=a.n(S),C=a(13),P=a.n(C),I=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_URL,B=void 0===I?"":I,U=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={username:null,password:null,error:null},a.uuids={username:x()(),password:x()()},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.token,a=e.history;return!t||(a.push("/"),!1)}},{key:"login",value:function(e){var t=this;e.preventDefault();var a=this.props,n=a.setToken,r=a.history,o=this.state,s=o.username,i=o.password;fetch("".concat(B,"/api/login"),{method:"POST",headers:{accept:"application/vnd.moosik.v1+json","content-type":"application/json"},body:JSON.stringify({username:s,password:i})}).then(function(e){return e.json()}).then(function(e){var a=e.token,o=e.message;a?(n(a),window.localStorage.setItem("token",a),r.push("/")):t.setState({error:o})}).catch(function(e){return t.setState({error:e.toString()})})}},{key:"input",value:function(e){e.preventDefault();var t=this.uuids,a=t.username,n=t.password,r=e.target,o=r.id,s=r.value;switch(o){case a:this.setState({username:s});break;case n:this.setState({password:s})}}},{key:"reset",value:function(){this.setState({error:null})}},{key:"render",value:function(){var e=this.state.error,t=this.uuids;return r.a.createElement("section",{className:P.a.login},r.a.createElement("h1",{className:P.a.head},"Login"),r.a.createElement("form",{className:P.a.body},r.a.createElement("label",{htmlFor:t.username,className:P.a.field},r.a.createElement("input",{id:t.username,className:P.a.textInput,type:"text",placeholder:"Username / Email",onChange:this.input.bind(this),onClick:this.reset.bind(this)})),r.a.createElement("label",{htmlFor:t.password,className:P.a.field},r.a.createElement("input",{id:t.password,className:P.a.textInput,type:"password",placeholder:"Password",onChange:this.input.bind(this),onClick:this.reset.bind(this)})),r.a.createElement("div",{className:P.a.field},r.a.createElement(l.b,{className:P.a.link,to:"/forgot"},"Forgot your password?"),r.a.createElement("div",{className:P.a.right},r.a.createElement(l.b,{className:P.a.link,to:"/register"},"Need an account?"),r.a.createElement("input",{className:P.a.submitButton,type:"submit",value:"Login",onClick:this.login.bind(this)})))),e&&r.a.createElement("p",{className:P.a.error},e))}}]),t}(r.a.Component),T=Object(i.b)(function(e){return{token:e.login.token}},function(e){return{setToken:function(t){return e(_(t))}}})(Object(h.e)(U)),A=a(11),L=a.n(A),R=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_URL,D=void 0===R?"":R,M=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={username:null,email:null,password:null,retry:null,error:null},a.uuids={username:x()(),email:x()(),password:x()(),retry:x()()},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.token,a=e.history;return!t||(a.push("/"),!1)}},{key:"register",value:function(e){var t=this;e.preventDefault();var a=this.props.history,n=this.state,r=n.username,o=n.email,s=n.password,i=n.retry;/[a-zA-Z0-9\-_]/.test(r)?s.length<8?this.setState({error:"Password too short. Use 8 or more characters."}):s===i?fetch("".concat(D,"/api/register"),{method:"POST",headers:{accept:"application/vnd.moosik.v1+json","content-type":"application/json"},body:JSON.stringify({username:r,email:o,password:s})}).then(function(e){return e.json()}).then(function(e){var n=e.uuid,r=e.message;n?a.push("/login"):t.setState({error:r})}).catch(function(e){return t.setState({error:e.toString()})}):this.setState({error:"Passwords don't match."}):this.setState({error:"Username must contain only English characters, numbers, dot, dash or underline."})}},{key:"input",value:function(e){e.preventDefault();var t=this.uuids,a=t.username,n=t.email,r=t.password,o=t.retry,s=e.target,i=s.id,l=s.value;switch(i){case a:this.setState({username:l});break;case n:this.setState({email:l});break;case r:this.setState({password:l});break;case o:this.setState({retry:l})}}},{key:"reset",value:function(){this.setState({error:null})}},{key:"render",value:function(){var e=this.state.error,t=this.uuids;return r.a.createElement("section",{className:L.a.register},r.a.createElement("h1",{className:L.a.head},"Register"),r.a.createElement("form",{className:L.a.body},r.a.createElement("label",{htmlFor:t.username,className:L.a.field},r.a.createElement("input",{ref:this.username,id:t.username,className:L.a.textInput,type:"text",placeholder:"Username",onChange:this.input.bind(this),onClick:this.reset.bind(this)})),r.a.createElement("label",{htmlFor:t.email,className:L.a.field},r.a.createElement("input",{ref:this.email,id:t.email,className:L.a.textInput,type:"email",placeholder:"Email",onChange:this.input.bind(this),onClick:this.reset.bind(this)})),r.a.createElement("label",{htmlFor:t.password,className:L.a.field},r.a.createElement("input",{ref:this.password,id:t.password,className:L.a.textInput,type:"password",placeholder:"Password",onChange:this.input.bind(this),onClick:this.reset.bind(this)})),r.a.createElement("label",{htmlFor:t.retry,className:L.a.field},r.a.createElement("input",{ref:this.retry,id:t.retry,className:L.a.textInput,type:"password",placeholder:"Re-type Password",onChange:this.input.bind(this),onClick:this.reset.bind(this)})),r.a.createElement("div",{className:L.a.field},r.a.createElement(l.b,{className:L.a.link,to:"/login"},"Already have account?"),r.a.createElement("input",{className:L.a.submitButton,type:"submit",value:"Register",onClick:this.register.bind(this)}))),e&&r.a.createElement("p",{className:L.a.error},e))}}]),t}(r.a.Component),F=Object(i.b)(function(e){return{token:e.login.token}})(Object(h.e)(M)),V=a(21),z=a.n(V),H=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_URL,Y=void 0===H?"":H,G=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={email:null,error:null},a.uuids={email:x()()},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.token,a=e.history;return!t||(a.push("/"),!1)}},{key:"requestPasswordChange",value:function(e){var t=this;e.preventDefault();var a=this.state.email;/^\w+[\w-.]*@\w+((-\w+)|(\w*))\.[a-z]{2,3}$/.test(a)?fetch("".concat(Y,"/api/forgot"),{method:"POST",headers:{accept:"application/vnd.moosik.v1+json","content-type":"application/json"},body:JSON.stringify({email:a})}).then(function(e){return e.json()}).then(function(e){t.setState({error:e.message})}).catch(function(e){return t.setState({error:e.toString()})}):this.setState({error:"Invalid email."})}},{key:"input",value:function(e){e.preventDefault(),this.setState({email:e.target.value})}},{key:"reset",value:function(){this.setState({error:null})}},{key:"render",value:function(){var e=this.state.error,t=this.uuids;return r.a.createElement("section",{className:z.a.forgot},r.a.createElement("h1",{className:z.a.head},"Forgot"),r.a.createElement("form",{className:z.a.body},r.a.createElement("div",{className:z.a.instruction},r.a.createElement("p",null,"To request a new password please enter your account email in the box below."),r.a.createElement("p",null,"We will send you an email with further instructions.")),r.a.createElement("label",{htmlFor:t.email,className:z.a.field},r.a.createElement("input",{ref:this.email,id:t.email,className:z.a.textInput,type:"email",placeholder:"Email",onChange:this.input.bind(this),onClick:this.reset.bind(this)})),r.a.createElement("div",{className:z.a.field},r.a.createElement("input",{className:z.a.submitButton,type:"submit",value:"Request Password Change",onClick:this.requestPasswordChange.bind(this)}))),e&&r.a.createElement("p",{className:z.a.error},e))}}]),t}(r.a.Component),W=Object(i.b)(function(e){return{token:e.login.token}})(Object(h.e)(G)),X="SET_SONGS",K="SET_NP",J="SET_PAUSE",q=function(e,t){return{type:e,payload:t}},Q=a(19),Z=a.n(Q),$=a(31),ee=a.n($),te=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"click",value:function(){var e=this.props,t=e.index,a=e.nowPlaying,n=e.setNowPlaying,r=e.paused,o=e.setPause;t===a?o(!r):n(t)}},{key:"render",value:function(){var e=this.props,t=e.author,a=e.title,n=e.cover,o=e.editable,s=e.index,i=e.nowPlaying,l=e.paused,c=s===i&&!l;return r.a.createElement("div",{className:Z.a.song},r.a.createElement("div",{className:Z.a.cover,style:{backgroundImage:"url(".concat(n,")")},role:"presentation",onClick:this.click.bind(this)},!n&&r.a.createElement("svg",{className:Z.a.defaultCover},r.a.createElement("use",{xmlnsXlink:"http://www.w3.org/1999/xlink",xlinkHref:"".concat(ee.a,"#defaultCover")})),r.a.createElement("svg",{className:Z.a.play},r.a.createElement("use",{xmlnsXlink:"http://www.w3.org/1999/xlink",xlinkHref:"".concat(ee.a,"#").concat(c?"pause":"play")}))),r.a.createElement("div",{className:Z.a.container},r.a.createElement("div",{className:Z.a.info},r.a.createElement("div",{className:Z.a.title},a),r.a.createElement("div",{className:Z.a.author},t)),r.a.createElement("div",{className:Z.a.actions},r.a.createElement("svg",{className:Z.a.button},r.a.createElement("use",{xmlnsXlink:"http://www.w3.org/1999/xlink",xlinkHref:"".concat(ee.a,"#").concat("select")})),o&&r.a.createElement("svg",{className:Z.a.button},r.a.createElement("use",{xmlnsXlink:"http://www.w3.org/1999/xlink",xlinkHref:"".concat(ee.a,"#edit")})))))}}]),t}(r.a.Component);te.defaultProps={cover:null,editable:!1};var ae=Object(i.b)(function(e){return{nowPlaying:e.player.nowPlaying,paused:e.player.paused}},function(e){return{setNowPlaying:function(t){return e(q(K,t))},setPause:function(t){return e(q(J,t))}}})(te),ne=a(32),re=a.n(ne),oe=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_URL,se=void 0===oe?"":oe,ie=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={error:null},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.token,n=t.setSongs;fetch("".concat(se,"/api/songs"),{method:"GET",headers:{accept:"application/vnd.moosik.v1+json","content-type":"application/json",authorization:"Bearer ".concat(a)}}).then(function(e){return e.json()}).then(function(t){var a=t.message,r=t.songs;r?n(r):e.setState({error:a})}).catch(function(t){return e.setState({error:t.toString()})})}},{key:"render",value:function(){var e=this.props.songs,t=this.state.error;return r.a.createElement("section",{className:re.a.music},r.a.createElement("h1",{className:re.a.head},"Music"),r.a.createElement("div",{className:re.a.songList},e.map(function(e,t){return r.a.createElement(ae,{key:e.uuid,author:e.author,title:e.title,cover:e.cover,index:t})})),t&&r.a.createElement("p",{className:re.a.error},t))}}]),t}(r.a.Component),le=Object(i.b)(function(e){return{token:e.login.token,songs:e.player.songs}},function(e){return{setSongs:function(t){return e(q(X,t))}}})(ie),ce=a(9),ue=a.n(ce),me=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_URL,pe=void 0===me?"":me,de=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={file:null,artist:null,title:null,fileName:null,error:null},a.uuids={file:x()(),artist:x()(),title:x()()},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.token,a=e.history;return!!t||(a.push("/"),!1)}},{key:"upload",value:function(e){var t=this;e.preventDefault();var a=this.props.token,n=this.state,r=n.file,o=n.artist,s=n.title;fetch("".concat(pe,"/api/songs"),{method:"PUT",headers:{accept:"application/vnd.moosik.v1+json","content-type":"audio/mpeg",authorization:"Bearer ".concat(a),"x-uploaded-filename":o&&s?"".concat(o," - ").concat(s):r.name},body:r}).then(function(e){return e.json()}).then(function(e){var a=e.uuid,n=e.message;t.setState({error:n})}).catch(function(e){return t.setState({error:e.toString()})})}},{key:"input",value:function(e){e.preventDefault();var t=this.uuids,a=t.file,n=t.artist,r=t.title,o=e.target,s=o.id,i=o.value,l=o.files;switch(s){case a:var c=l[0].name;this.setState({fileName:c}),this.setState({file:l[0]});break;case n:this.setState({artist:i});break;case r:this.setState({title:i})}}},{key:"render",value:function(){var e=this.state,t=e.fileName,a=e.error,n=this.uuids;return r.a.createElement("section",{className:ue.a.upload},r.a.createElement("h1",{className:ue.a.head},"Upload"),r.a.createElement("div",{className:ue.a.instruction},r.a.createElement("p",null,"Your audio file may not exceed 10 MB and has to be in MP3 format.")),r.a.createElement("form",{className:ue.a.body},r.a.createElement("div",{className:ue.a.field},t&&r.a.createElement("span",{className:ue.a.selectedFile},t),r.a.createElement("label",{className:ue.a.fileInput,htmlFor:n.file},r.a.createElement("input",{ref:this.file,id:n.file,type:"file",accept:"audio/mpeg",onChange:this.input.bind(this)}),r.a.createElement("span",null,"Choose File"))),r.a.createElement("div",{className:ue.a.additionalInfo},r.a.createElement("h3",{className:ue.a.title},"Additional Information"),r.a.createElement("label",{htmlFor:n.artist,className:ue.a.field},r.a.createElement("input",{ref:this.artist,id:n.artist,className:ue.a.textInput,type:"text",placeholder:"Artist (Optional)",onChange:this.input.bind(this)})),r.a.createElement("label",{htmlFor:n.title,className:ue.a.field},r.a.createElement("input",{ref:this.title,id:n.title,className:ue.a.textInput,type:"text",placeholder:"Name (Optional)",onChange:this.input.bind(this)}))),r.a.createElement("div",{className:ue.a.field},r.a.createElement("input",{className:ue.a.submitButton,type:"submit",value:"Upload",onClick:this.upload.bind(this)}))),a&&r.a.createElement("p",{className:ue.a.error},a))}}]),t}(r.a.Component),he=Object(i.b)(function(e){return{token:e.login.token}})(Object(h.e)(de)),_e=[{path:"/",component:function(){return r.a.createElement(O,null)},exact:!0},{path:"/music",component:function(){return r.a.createElement(le,null)}},{path:"/upload",component:function(){return r.a.createElement(he,null)}},{path:"/login",component:function(){return r.a.createElement(T,null)}},{path:"/register",component:function(){return r.a.createElement(F,null)}},{path:"/forgot",component:function(){return r.a.createElement(W,null)}}],fe=a(46),ge=a.n(fe),ve=function(){return r.a.createElement("div",{className:ge.a.main},_e.map(function(e){return r.a.createElement(h.a,{key:e.path.slice(1),path:e.path,component:e.component,exact:e.exact})}))},be=a(42),Ee=a.n(be),ye=a(25),ke=a.n(ye),Ne=function(e){var t=e.timePassed,a=e.duration;return r.a.createElement("div",{className:ke.a.timeline},r.a.createElement("div",{className:ke.a.timePassed},Ee()(1e3*t).format("mm:ss")),r.a.createElement("div",{className:ke.a.progressWrapper},r.a.createElement("div",{className:ke.a.progressBackground},r.a.createElement("div",{className:ke.a.progressBar,style:{width:"".concat(t/a*100,"%")}}))),r.a.createElement("div",{className:ke.a.duration},Ee()(1e3*a).format("mm:ss")))},we=a(24),je=a.n(we),Oe=function(e){var t=e.author,a=e.title,n=e.cover;return r.a.createElement("div",{className:je.a.soundBadge},r.a.createElement("div",{className:je.a.cover,style:{backgroundImage:"url(".concat(n,")")}}),r.a.createElement("div",{className:je.a.titleContextContainer},r.a.createElement("span",{className:"".concat(je.a.title," ").concat(je.a.truncate)},a),r.a.createElement("span",{className:"".concat(je.a.author," ").concat(je.a.truncate)},t)))};Oe.defaultProps={author:"No Author",title:"No Title",cover:""};var Se=Oe,xe=a(3),Ce=a.n(xe),Pe=a(28),Ie=a.n(Pe),Be=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_URL,Ue=void 0===Be?"":Be,Te=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={song:{},currentTime:0,duration:0,volume:1,muted:!1,loop:!1},a.audio=Object(n.createRef)(),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.token,a=e.setSongs;fetch("".concat(Ue,"/api/songs"),{method:"GET",headers:{accept:"application/vnd.moosik.v1+json","content-type":"application/json",authorization:"Bearer ".concat(t)}}).then(function(e){return e.json()}).then(function(e){var t=e.message,n=e.songs;n?a(n):console.error(t)}).catch(console.error)}},{key:"componentDidUpdate",value:function(e){var t=this,a=this.props,n=a.token,r=a.songs,o=a.nowPlaying,s=a.paused;if(r.length)if(e.nowPlaying===o){if(e.paused!==s){var i=this.audio.current;s?i.pause():i.play()}}else fetch("".concat(Ue,"/api/songs/").concat(r[o].uuid),{method:"GET",headers:{accept:"application/vnd.moosik.v1+json","content-type":"application/json",authorization:"Bearer ".concat(n)}}).then(function(e){return e.json()}).then(function(e){var a=e.message,n=e.song;n?t.setState({song:n}):console.error(a)}).catch(console.error)}},{key:"onCanPlay",value:function(e){(0,this.props.setPause)(e.target.paused)}},{key:"onTimeUpdate",value:function(e){var t=e.target,a=t.currentTime,n=t.duration;this.setState({currentTime:a,duration:n})}},{key:"onVolumeChange",value:function(e){var t=e.target.volume;this.setState({volume:t})}},{key:"onEnded",value:function(){var e=this.props,t=e.songs,a=e.nowPlaying,n=e.setNowPlaying;a<t.length-1&&n(a+1)}},{key:"play",value:function(){var e=this.props,t=e.nowPlaying,a=e.setNowPlaying,n=e.paused,r=e.setPause;-1!==t?r(!n):a(-1===t?0:t)}},{key:"mute",value:function(){this.setState(function(e){return{muted:!e.muted}})}},{key:"changeVolume",value:function(e){var t=e.target;t.classList.contains(Ce.a.volumeBar)&&(t=t.parentNode);var a=t.getBoundingClientRect(),n=(e.clientY-a.top)/a.height;n<0||n>1||(this.audio.current.volume=n)}},{key:"repeat",value:function(){this.setState(function(e){return{loop:!e.loop}})}},{key:"prev",value:function(){var e=this.props,t=e.nowPlaying,a=e.setNowPlaying;t>0&&a(t-1)}},{key:"next",value:function(){var e=this.props,t=e.songs,a=e.nowPlaying,n=e.setNowPlaying;a<t.length-1&&n(a+1)}},{key:"render",value:function(){var e=this.props.paused,t=this.state,a=t.song,n=t.currentTime,o=t.duration,s=t.muted,i=t.loop,l=t.volume;return r.a.createElement("div",{className:Ce.a.playControls},r.a.createElement("section",{className:Ce.a.wrapper},r.a.createElement("div",{className:Ce.a.controls},r.a.createElement("button",{type:"button",className:Ce.a.control,onClick:this.prev.bind(this)},r.a.createElement("svg",{className:Ce.a.controlIcon},r.a.createElement("use",{xmlnsXlink:"http://www.w3.org/1999/xlink",xlinkHref:"".concat(Ie.a,"#prev")}))),r.a.createElement("button",{type:"button",className:Ce.a.control,onClick:this.play.bind(this)},r.a.createElement("svg",{className:Ce.a.controlIcon},r.a.createElement("use",{xmlnsXlink:"http://www.w3.org/1999/xlink",xlinkHref:"".concat(Ie.a,"#").concat(e?"play":"pause")}))),r.a.createElement("button",{type:"button",className:Ce.a.control,onClick:this.next.bind(this)},r.a.createElement("svg",{className:Ce.a.controlIcon},r.a.createElement("use",{xmlnsXlink:"http://www.w3.org/1999/xlink",xlinkHref:"".concat(Ie.a,"#next")}))),r.a.createElement("button",{type:"button",className:Ce.a.control,onClick:this.repeat.bind(this)},r.a.createElement("svg",{className:Ce.a.controlIcon},r.a.createElement("use",{xmlnsXlink:"http://www.w3.org/1999/xlink",xlinkHref:"".concat(Ie.a,"#repeat"),style:{fill:i?"var(--red-dark)":""}})))),r.a.createElement(Ne,{timePassed:n,duration:o}),r.a.createElement("div",{className:"".concat(Ce.a.controls," ").concat(Ce.a.volume)},r.a.createElement("button",{type:"button",className:Ce.a.control,onClick:this.mute.bind(this)},r.a.createElement("svg",{className:Ce.a.controlIcon},r.a.createElement("use",{xmlnsXlink:"http://www.w3.org/1999/xlink",xlinkHref:"".concat(Ie.a,"#").concat(s?"mute":"volume")}))),r.a.createElement("div",{className:Ce.a.volumeWrapper,role:"presentation",onClick:this.changeVolume.bind(this)},r.a.createElement("div",{className:Ce.a.volumeBackground},r.a.createElement("div",{className:Ce.a.volumeBar,style:{height:"".concat(100*l,"%")}})))),r.a.createElement(Se,{author:a.author,title:a.title,cover:a.cover}),r.a.createElement("audio",{ref:this.audio,autoPlay:!0,src:a.url,muted:s,loop:i,onCanPlay:this.onCanPlay.bind(this),onTimeUpdate:this.onTimeUpdate.bind(this),onVolumeChange:this.onVolumeChange.bind(this),onEnded:this.onEnded.bind(this)})))}}]),t}(r.a.Component),Ae=Object(i.b)(function(e){return{token:e.login.token,songs:e.player.songs,nowPlaying:e.player.nowPlaying,paused:e.player.paused}},function(e){return{setSongs:function(t){return e(q(X,t))},setNowPlaying:function(t){return e(q(K,t))},setPause:function(t){return e(q(J,t))}}})(Te),Le=a(37),Re=a.n(Le),De=a(47),Me=a.n(De),Fe=Object(i.b)(function(e){return{token:e.login.token}})(function(e){var t=e.token;return r.a.createElement("div",{className:Re.a.app},r.a.createElement("div",{className:Re.a.background,style:{backgroundImage:"url(".concat(Me.a,")")}}),r.a.createElement("main",{className:Re.a.container},r.a.createElement(l.a,null,r.a.createElement(b,null),r.a.createElement(ve,null)),t&&r.a.createElement(Ae,null)))}),Ve=a(26),ze=a(27),He={token:window.localStorage.getItem("token")||""},Ye={songs:[],nowPlaying:-1,paused:!0},Ge=Object(Ve.b)({login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TOKEN":return Object(ze.a)({},e,{token:t.payload});default:return e}},player:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SONGS":return Object(ze.a)({},e,{songs:t.payload});case"SET_NP":return Object(ze.a)({},e,{nowPlaying:t.payload});case"SET_PAUSE":return Object(ze.a)({},e,{paused:t.payload});default:return e}}}),We=Object(Ve.c)(Ge);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(61);s.a.render(r.a.createElement(i.a,{store:We},r.a.createElement(Fe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[48,1,2]]]);
//# sourceMappingURL=main.6aaa323f.chunk.js.map